---
title: "Azure Database for MySQL Flexible Serverã®Auto scale IOPSãŒå›ºå®šIOPSã‚ˆã‚ŠãŠå¾—ã‹ï¼Ÿ"
emoji: "ğŸ’½"
type: "tech"
topics:
  - "azure"
  - "mysql"
  - "database"
  - "ã‚³ã‚¹ãƒˆæœ€é©åŒ–"
  - "aeon"
published: true
published_at: "2024-09-12 09:00"
publication_name: "aeonpeople"
---

ã“ã‚“ã«ã¡ã¯ã€‚ã‚¤ã‚ªãƒ³ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼æ ªå¼ä¼šç¤¾ï¼ˆASTï¼‰ã§SREãƒãƒ¼ãƒ ã®æ— aka [ã‚‚ã‚Šã¯ã‚„](https://twitter.com/morihaya55)ã§ã™ã€‚

æœ¬è¨˜äº‹ã¯Azureã®ãƒãƒãƒ¼ã‚¸ãƒ‰ãªMySQLã§ã‚ã‚‹â€Azure Database for MySQL Flexible Serverâ€ã®2ã¤ã®IOPSè¨­å®šã®æ©Ÿèƒ½ã‚„ã‚³ã‚¹ãƒˆã«ã¤ã„ã¦ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

## TL;DR
å§‹ã‚ã«ã¾ã¨ã‚ã§ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ä»¥ä¸‹ã«ã¤ã„ã¦è¨˜è¿°ã—ã¾ã—ãŸã€‚

- Azure Database for MySQL Flexible Serverã®IOPSã®è¨­å®šã¯2ã¤ã‚ã‚‹
    - å¾“æ¥ã®å›ºå®šå¼ãªPre-provisioned IOPS
    - å‹•çš„ã«æœ€é©åŒ–ã•ã‚Œã‚‹Auto scale IOPS
- ã‚µãƒãƒ¼ãƒˆåœæ­¢ã™ã‚‹Azure Database for MySQL Single Serverã¨ç•°ãªã‚Šã€IOPSã®MAXã¯ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã§ã¯ãªãCompute sizeã«ã‚ˆã£ã¦æ±ºå®šã•ã‚Œã‚‹
- å¹…ä½åºƒã„ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã«å¯¾ã—ã¦æœ‰åŠ¹ãªã®ã¯Auto scale IOPSã§ã‚ã‚‹
- ã‚·ãƒ³ãƒ—ãƒ«ã«ã‚³ã‚¹ãƒˆæ¯”è¼ƒã™ã‚‹ãªã‚‰å®Ÿéš›ã«å‹•ä½œã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®Storage IO Count metricã‚’è¦‹ã‚‹


## MySQL Single Serverã®ã‚µãƒãƒ¼ãƒˆçµ‚äº†

Azureãƒ¦ãƒ¼ã‚¶ã§Azure Database for MySQL Single Serverï¼ˆä»¥å¾ŒSingle Serverï¼‰ã‚’åˆ©ç”¨ã—ã¦ã„ãŸçš†æ§˜ã¯ã€2024å¹´09æœˆ16æ—¥ã®ã‚µãƒãƒ¼ãƒˆçµ‚äº†ã«å‘ã‘ã¦å…¨ã¦Azure Database for MySQL Flexible Serverï¼ˆä»¥å¾ŒFlexible Serverï¼‰ã¸ç§»è¡ŒãŒçµ‚ã‚ã£ãŸé ƒã ã¨æ€ã„ã¾ã™ã€‚ï¼ˆç§ãŸã¡ASTã‚‚é–‹ç™ºãƒãƒ¼ãƒ ã®é ‘å¼µã‚Šã«ã‚ˆã£ã¦ç„¡äº‹ã«ç§»è¡Œã‚’çµ‚ãˆã¾ã—ãŸï¼‰

https://learn.microsoft.com/en-us/azure/mysql/migrate/whats-happening-to-mysql-single-server#what-happens-post-sunset-date-september-16-2024


ä¸Šè¨˜ã®å…¬å¼ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ã«ã‚ˆã‚Œã°ã€Single ServerãŒçµ‚äº†ã™ã‚‹ã®ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å½±éŸ¿ãŒä¸»ãªç†ç”±ã¨ãªã£ã¦ã„ã¾ã™ã€‚

> Running the Single Server instance post sunset date would be a security risk, as there will be no security and bug fixes maintenance on the deprecated Single Server platform.

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯å½“ç¤¾ã®ã‚ˆã†ãªç¤¾ä¼šçš„è²¬ä»»ã‚ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’é‹ç”¨ã™ã‚‹éš›ã«æœ€å„ªå…ˆã™ã¹ãäº‹é …ã§ã‚ã‚‹ä¸€æ–¹ã€æ˜ç¢ºãªãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ç†è§£ã•ã‚Œã¥ã‚‰ã„è¦³ç‚¹ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚

ã“ã®ç‚¹ã«é–¢ã—ã¦ã‚‚ä¸Šè¨˜ã®ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ã¯ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãŠã‚Š[Frequently Asked Questions (FAQs) ](https://learn.microsoft.com/en-us/azure/mysql/migrate/whats-happening-to-mysql-single-server#frequently-asked-questions-faqs)ã®æ®µè½ã«ãŠã„ã¦æ˜ç¢ºã«ã‚³ã‚¹ãƒˆãƒ¡ãƒªãƒƒãƒˆã‚„é‹ç”¨è² è·è»½æ¸›ã«ã¤ã„ã¦è¨˜è¼‰ãŒã‚ã‚Šã¾ã™ã€‚

> Q. Why am I being asked to migrate to Azure Database for MySQL - Flexible Server?
> 
> A. Azure Database for MySQL - Flexible Server is the best platform for running all your MySQL workloads on Azure. Azure MySQL- Flexible server is both economical and provides better performance across all service tiers and more ways to control your costs, for cheaper and faster disaster recovery:
> 
> - More ways to optimize costs, including support for burstable tier compute options.
> - Improved performance for business-critical production workloads that require low latency, high concurrency, fast failover, and high scalability.
> - Improved uptime with the ability to configure a hot standby on the same or a different zone, and a one-hour time window for planned server maintenance.


ä»Šå›ç„¦ç‚¹ã‚’å½“ã¦ã‚‹ã®ã¯ä¸Šè¨˜ã®ä¸­ã§ã‚‚"More ways to optimize costs"ã®è¦³ç‚¹ã‹ã‚‰"[Auto scale IOPS](https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-storage-iops#autoscale-iops)"ã«ãªã‚Šã¾ã™ã€‚


## å¾“æ¥ã®Single Serverã«ãŠã‘ã‚‹IOPSã¯ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã«æ¯”ä¾‹ã—ãŸ

Flexible Serverã®Flexibleï¼ˆæŸ”è»Ÿï¼‰ãŸã‚‹ãƒã‚¤ãƒ³ãƒˆã®ä¸€ã¤ãŒ"Auto scale IOPS"ã§ã™ã€‚å¾“æ¥ã®Single Serverã«ãŠã„ã¦ã€IOPSã¯ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã«ç´ã¥ãã‚‚ã®ã§ã—ãŸã€‚

[Resource limits for single databases using the vCore purchasing model](https://learn.microsoft.com/en-us/previous-versions/azure/mysql/single-server/concepts-pricing-tiers#storage)

ä¸Šè¨˜ã®Single Serverã®åˆ¶ç´„ã‹ã‚‰IOPSéƒ¨åˆ†ã«ã¤ã„ã¦å¼•ç”¨ã—ã¾ã™ã€‚(ä¸Šè¨˜ãƒšãƒ¼ã‚¸ã¯Single Serverã®ã‚µãƒãƒ¼ãƒˆçµ‚äº†ã¨ã¨ã‚‚ã«æ¶ˆãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™...ï¼‰

| Storage type| Basic | General purpose v1 | General purpose v2|
| ------------ | ---- | ------------------  | ----------------- |
| Storage size	| 5 GB to 1 TB	| 5 GB to 4 TB	| 5 GB to 16 TB |
| Storage increment size| 1 GB | 1 GB | 1 GB |
|IOPS | Variable | 3 IOPS/GB <br> Min 100 IOPS <br> Max 6,000 IOPS | 3 IOPS/GB <br> Min 100 IOPS <br> Max 20,000 IOPS|


è¡¨ã‹ã‚‰Single Serverã®IOPSã«ã¤ã„ã¦ãƒã‚¤ãƒ³ãƒˆã‚’ã¾ã¨ã‚ã¾ã™ã€‚
- General purpose v1ã¨v2ã§MAX IOPSãŒ3å€ä»¥ä¸Šã®å·®ãŒã‚ã‚‹(`6,000 vs 20,000`)
- `3 IOPS/GB` ã‚ˆã‚Šã€å‰²ã‚Šå½“ã¦ãŸãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã«ã‚ˆã£ã¦IOPSãŒæ±ºå®šã•ã‚Œã‚‹

å…·ä½“çš„ã«ã¯General purpose v2ã®MAX IOPS `20,000` ã‚’ã‚µãƒ¼ãƒ“ã‚¹ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¦æ±‚ã—ãŸå ´åˆã€ `20,000 / 3 = ç´„6,666.6GB = ç´„6.7TB` ä»¥ä¸Šã®ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

ã“ã®åˆ¶ç´„ã«ã‚ˆã£ã¦å½“ç¤¾ã®Single Serverã®åˆ©ç”¨ã«ãŠã„ã¦IOPSã®ç¢ºä¿ã‚’ç›®çš„ã¨ã—ã¦å¤§å¹…ã«è¶…éã—ãŸãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Š`Storage Used(%)` ãŒ`1%`ã‚’ä¸‹å›ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå­˜åœ¨ã™ã‚‹çŠ¶æ³ã§ã—ãŸ...


![å›³: Single Serverã®Storage Used(%)ã‚’è¡¨ç¤ºã—ãŸNew Relicã®ã‚°ãƒ©ãƒ•](https://storage.googleapis.com/zenn-user-upload/515b767d1b30-20240912.png)

## Flexible Serverã¯æŸ”è»ŸãªIOPSæŒ‡å®šãŒå¯èƒ½ã«ãªã£ãŸã€ãŸã ã—Compute sizeã«ã‚ˆã‚‹

ä¸Šè¿°ã—ãŸSingle Serverã®åˆ¶ç´„ã«å¯¾ã—ã€Flexible Serverã¯IOPSã®æŒ‡å®šãŒãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã®åˆ¶ç´„ã‹ã‚‰å®Œå…¨ã«åˆ‡ã‚Šé›¢ã•ã‚Œã¦ã„ã¾ã™ã€‚

[Pre-provisioned IOPS](https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-storage-iops#pre-provisioned-iops)

ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

> You can use pre-provisioned IOPS to allocate a specific number of IOPS to your Azure Database for MySQL - Flexible Server instance. 

ã“ã“ã§æ°—ã‚’ã¤ã‘ãªã‘ã‚Œã°ãªã‚‰ãªã„ç‚¹ã¨ã—ã¦ã€Flexible Serverã®MAX IOPSã¯ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã«å½±éŸ¿ã•ã‚Œãªããªã‚Šã¾ã—ãŸãŒã€Compute sizeã«ã‚ˆã£ã¦åˆ¶é™ã•ã‚Œã‚‹ç‚¹ã§ã™ã€‚

ä»¥ä¸‹ã¯å®Ÿéš›ã«Flexible Serverã‚’ä½œæˆã™ã‚‹ç”»é¢ã§ã™ã€‚Compute sizeã«ã‚ˆã£ã¦MAX IOPSãŒæ˜ç¢ºã«åˆ¶é™ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ï¼ˆä¾‹: Standard_D16ads_v5ã®å ´åˆ `20,000 max iops`ï¼‰
![](https://storage.googleapis.com/zenn-user-upload/b72cfc582e69-20240912.png)

ã“ã®æŒ‡å®šå¯èƒ½ãªIOPSã®åˆ¶é™ãŒã€ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‹ã‚‰Compute sizeã«ã‚ˆã£ã¦åˆ¶é™ã•ã‚Œã‚‹å¤‰æ›´ã¯å¤šãã®ã‚·ã‚¹ãƒ†ãƒ ã«ã¨ã£ã¦å¥½æ„çš„ãªå¤‰æ›´ã¨è¨€ãˆã‚‹ã§ã—ã‚‡ã†ã€‚ä¸€èˆ¬çš„ã«é«˜ã„IOPSã‚’å¿…è¦ã¨ã™ã‚‹ã‚±ãƒ¼ã‚¹ã§ã¯é«˜ã„CPUã‚„ãƒ¡ãƒ¢ãƒªãŒè¦æ±‚ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ãŸã‚ã§ã™ã€‚

## Flexible Serverã®"Auto scale IOPS"ã®ãƒ¡ãƒªãƒƒãƒˆ

ä¸Šè¿°ã—ãŸPre-provisioned IOPSã ã‘ã§ãªãã€Flexible Serverã§ã¯IOPSã«ã¤ã„ã¦"Auto scale IOPS"ã¨å‘¼ã°ã‚Œã‚‹æŸ”è»Ÿãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-storage-iops#autoscale-iops

"Auto scale IOPS"ã®æ¦‚è¦ã‚’ä»¥ä¸‹ã«å¼•ç”¨ã—ã¾ã™ã€‚

> Autoscale IOPS offer the flexibility to scale IOPS on demand. When you enable autoscale IOPS, your server automatically adjusts the IOPS limit of your database server based on the demand of your workload.

æ„è¨³ã™ã‚Œã°ã€ŒAuto scale IOPSãŒæœ‰åŠ¹ãªå ´åˆã€DBã«è¦æ±‚ã•ã‚ŒãŸãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã«å¿œã˜ã¦è‡ªå‹•çš„ã«IOPSãŒæœ€é©åŒ–ã•ã‚Œã‚‹ã€ã¨ã‚ã‚Šã¾ã™ã€‚

å¤¢ã®ã‚ˆã†ãªæ©Ÿèƒ½ã«æ€ãˆã¾ã™ãŒã€Pre-provisionedåŒæ§˜ã«MAX IOPSã¯Compute sizeã«ã‚ˆã£ã¦åˆ¶é™ã•ã‚Œã¾ã™ã€‚

https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-service-tiers-storage#service-tiers-size-and-server-types

## Pre-provisioned vs Auto scale

ã•ã¦ã“ã“ã§Flexible Serverã‚’ä½œæˆã™ã‚‹ã«ã‚ãŸã‚Šã€ç§ãŸã¡ã¯Pre-provisioned IOPSã‹Auto scale IOPSã‹é¸æŠã‚’è¿«ã‚‰ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

ã“ã®æ‚©ã¿ã«å¯¾ã—ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æ˜ç¢ºãªå›ç­”ã‚’æä¾›ã—ã¦ãã‚Œã¾ã™ã€‚

https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-storage-iops#throttling-impact

ä¸Šè¨˜ã‚ˆã‚Šãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰åˆ¥ã®Pre-provisioned IOPSã¨Auto scale IOPSã®èª¬æ˜è¡¨ã‚’å¼•ç”¨ã—ã¾ã™ã€‚

| Workload considerations | Pre-provisioned IOPS | Auto scale IOPS |
| ----------------------- | -------------------- | -------------- |
| Workloads with consistent and predictable I/O patterns | Recommended,<br> because it uses only provisioned IOPS | Compatible,<br> with no manual provisioning of IOPS required |
| Workloads with varying usage patterns |Not recommended,<br> because it might not provide efficient performance during high usage periods. |Recommended,<br> because it automatically adjusts to handle varying workloads |
| Workloads with dynamic growth or changing performance needs |Not recommended,<br> because it requires constant adjustments for changing IOPS requirements |Recommended,<br> because no extra settings are required for specific throughput requirements |

ä¸€ã¤ä¸€ã¤ã®èª¬æ˜ã‚’èª­ã‚€ã“ã¨ã§ç´å¾—ãŒã„ãã¾ã™ãŒã€ç°¡ç•¥åŒ–ã™ã‚‹ã¨ãã®å·®ã¯ä¸€ç›®ç­ç„¶ã§ã™ã€‚

| Workload considerations | Pre-provisioned IOPS | Auto scale IOPS |
| ----------------------- | -------------------- | -------------- |
| Workloads with consistent and predictable I/O patterns | âœ…Recommended | ğŸ‘ŒCompatible |
| Workloads with varying usage patterns |ğŸ™…Not recommended|âœ…Recommended|
| Workloads with dynamic growth or changing performance needs |ğŸ™…Not recommended|âœ…Recommended|

1è¡Œç›®ã®"Workloads with consistent and predictable I/O patterns"ã‚’é™¤ãã€Auto scale IOPSãŒæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã—ã€"Workloads with consistent and predictable I/O patterns"ã«ã¤ã„ã¦ã‚‚"Compatible"ã§ã‚ã‚‹ã“ã¨ãŒæ˜è¨˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã“ã‹ã‚‰å¤šãã®ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã®ã‚±ãƒ¼ã‚¹ã§Auto scale IOPSã‚’é¸æŠã™ã‚‹ã“ã¨ãŒé©åˆ‡ã§ã‚ã‚‹ã¨èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

## ã‚³ã‚¹ãƒˆã®æç›Šåˆ†å²ç‚¹ã¯ï¼Ÿ

å¹…åºƒã„ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã«ãŠã„ã¦Auto scale IOPSãŒé©ã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã£ãŸä¸€æ–¹ã§ã€SREã‚„ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ãŒæ°—ã«ã™ã¹ãç‚¹ã®ä¸€ã¤ã¯ã‚³ã‚¹ãƒˆã§ã™ã€‚

ç¬¬47å› Tokyo Jazug Nightã«ãŠã„ã¦ã€åŒåƒšã®å²©å´ã•ã‚“ã®ç™ºè¡¨ã«ã‚‚ã‚ã£ãŸã‚ˆã†ã«ã€ç§ãŸã¡ã®ãƒãƒ¼ãƒ ã¯æ—¥ã€…Azureã‚³ã‚¹ãƒˆã®æœ€é©åŒ–ã«å¥®é—˜ã—ã¦ã„ã¾ã™ã€‚

https://jazug.connpass.com/event/307679/

@[speakerdeck](8988de9d12e74127949f7f3bc2f14514)


Single Serverã‚’åˆ©ç”¨ã—ã¦ã„ãŸéš›ã¯å¿…ç„¶çš„ã«Pre-provisioned IOPSã®ã‚ˆã†ãªå›ºå®šã®IOPSã‚’æŒ‡å®šã—ã¦ã„ãŸã“ã¨ã§ã€ãã‚Œã‚’å®Ÿç¸¾ã¨ã—ã¦Flebixble Serverã«ãŠã„ã¦ã‚‚Pre-provisioned IOPSã‚’é¸æŠã™ã‚‹ã®ãŒå®‰å¿ƒã¨è¨€ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

å¾“æ¥ã®å®Ÿç¸¾ãŒPre-provisioned IOPSã«ã‚ã‚‹ã¨ã™ã‚Œã°ã€Auto scale IOPSã‚’é¸ã¶å‹•æ©Ÿã¨ã—ã¦ã‚³ã‚¹ãƒˆãƒ¡ãƒªãƒƒãƒˆãŒé‡è¦ã¨ãªã‚Šã¾ã™ã€‚

ãã‚Œãã‚Œã®ã‚³ã‚¹ãƒˆã«ã¤ã„ã¦[Pricing](https://azure.microsoft.com/en-us/pricing/details/mysql/#pricing)ãƒšãƒ¼ã‚¸ã‚ˆã‚Šä»¥ä¸‹ã«ã¾ã¨ã‚ã¾ã™ã€‚å˜ä½ãŒåŒã˜ã§ã¯ãªã„ãŸã‚å˜ç´”æ¯”è¼ƒã¯ã§ãã¾ã›ã‚“ã€‚

| Type | Price | Unit |
| ---- | ----- | ---- |
| Pre-provisioned IOPS<br>(Additional IOPS) | $0.06 | IOPS/month |
| Auto scale IOPS<br>(Paid IO Locally redundant storage (LRS)) | $0.29 |per million IOPS |
| Auto scale IOPS<br>(Paid IO Zone redundant storage (ZRS)	| $0.363 |per million IOPS |


ä¾‹ã¨ã—ã¦ `Standard_D16ads_v5 16vCores, 64GiB memory, 20,000 max iops` ã®ã‚±ãƒ¼ã‚¹ã§è€ƒãˆã¾ã™ã€‚åŸºæº–ã¨ã™ã‚‹æœŸé–“ã‚’1æœˆ(30æ—¥)é–“ã¨ã—ã€å¹³å‡IOPSã‚’å¤‰æ•°ã¨ã—ãŸå ´åˆã‚³ã‚¹ãƒˆã®ã‚°ãƒ©ãƒ•ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰é·ã—ã¦ã„ãã¾ã™ã€‚å›ºå®šã®Pre-provisionedã¯MAXã®`20,000`ã‚’æŒ‡å®šã—ã¾ã™ãŒã€å®Ÿéš›ã«ã¯`20,000`ä»¥ä¸‹ã‚’æŒ‡å®šå¯èƒ½ã§ã‚ã‚‹ã“ã¨ã¯ç•™æ„ãã ã•ã„ã€‚

:::details å…·ä½“çš„ãªè¨ˆç®—æ–¹æ³•
è¨ˆç®—å¼ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡Œãªã£ã¦ã„ã¾ã™ã€‚

- Pre-provisioned IOPS: MAX 20,000 * $0.06 = $12,000/Month
- Auto scale IOPS: æœˆã®å¹³å‡IOPS N * 30(days) * 60(Hours) * 60(Minutes) / 1,000,000 = $ã‚³ã‚¹ãƒˆ/Month 
:::

![](https://storage.googleapis.com/zenn-user-upload/901a14dc4cfe-20240912.png)

æç›Šåˆ†å²ç‚¹ã¯æœˆã®å¹³å‡IOPSãŒ `1,000ã‹ã‚‰2,000` ã®é–“ã«åã¾ã‚Šã¾ã—ãŸã€‚ã¤ã¾ã‚ŠMAXã® `20,000` ã«å¯¾ã—ã¦ `æœˆã®å¹³å‡IOPSãŒ5%ã‹ã‚‰10%ä»¥ä¸‹`ã§ã‚ã‚Œã°ã€Auto scale IOPSã®æ–¹ãŒã‚³ã‚¹ãƒˆãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã¨è¨€ãˆã¾ã™ã€‚



ä»¥ä¸‹ã¯ã¨ã‚ã‚‹Flexible Serverã«å¯¾ã—ã€Azure Portal -> Flexible Server -> Metrixã®ç”»é¢ã§ä»¥ä¸‹ã‚’é¸æŠã—ãŸçµæœã§ã™ã€‚

- Metric: Storage IO Percent
- Aggrigation: Average

![](https://storage.googleapis.com/zenn-user-upload/1429c8135703-20240912.png)

ç›´è¿‘1æœˆé–“ã®å¹³å‡Storage IO PercentãŒ`2.3484% = ç´„2.4%`ã§ã‚ã‚‹ãŸã‚ã€æç›Šåˆ†å²ç‚¹ã§ã‚ã‚‹`å¹³å‡IOPS 5%` ã®åŠåˆ†ä»¥ä¸‹ã§ã‚ã‚Šã€Pre-provisionedã§ã¯ãªãAuto scale IOPSã«ã—ãŸæ–¹ãŒã‚³ã‚¹ãƒˆå‰Šæ¸›ã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã¨åˆ¤æ–­ã§ãã¾ã™ã€‚

## ã‚‚ã£ã¨ã‚·ãƒ³ãƒ—ãƒ«ã«IOPSã‚³ã‚¹ãƒˆã‚’èª¿ã¹ã‚‹ãŸã‚ã«ã¯Storage IO Count metricã‚’è¦‹ã‚‹

ã‚°ãƒ©ãƒ•åŒ–ã™ã‚‹ãŸã‚ã«å¹³å‡IOPSã‚’åˆ©ç”¨ã™ã‚‹ãªã©ã—ã¦ã”ã¡ã‚ƒã”ã¡ã‚ƒã¨è¨ˆç®—ã—ã¾ã—ãŸãŒã€å®Ÿéš›ã«ç¨¼åƒã—ã¦ã„ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®IOPSã‚³ã‚¹ãƒˆã‚’èª¿ã¹ã‚‹ã®ã¯ç°¡å˜ã§ã™ã€‚

[Frequently asked questions](https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-storage-iops#frequently-asked-questions)ã‹ã‚‰ä»¥ä¸‹ã«å¼•ç”¨ã—ã¾ã™ã€‚

> How do I know how many IOPS I've used in Azure Database for MySQL - Flexible Server?
> 
> Go to Monitoring in the Overview section, or go to the Storage IO Count metric on the Monitoring pane. The Storage IO Count metric gives the sum of IOPS that the server used in the selected timeframe.

ä»¥ä¸‹ã¯ã¨ã‚ã‚‹Flexible Serverã«å¯¾ã—ã€Azure Portal -> Flexible Server -> Metrixã®ç”»é¢ã§ä»¥ä¸‹ã‚’é¸æŠã—ãŸçµæœã§ã™ã€‚

- Metric: Storage IO Count
- Aggrigation: Sum

![](https://storage.googleapis.com/zenn-user-upload/fcf3db2ac09e-20240912.png)

ç›´è¿‘30æ—¥é–“ã®Storage IO Countã®æ•°å€¤ãŒ`1.23B`ã¨ãªã£ã¦ã„ã‚‹ãŸã‚LRSã®`$0.29 per million IOPS`ã§è¨ˆç®—ã™ã‚‹ã¨`1,230,000,000 * 0.29 / 1,000,000 = $356/Month`ã¨ãªã‚Šã¾ã™ã€‚

Pre-provisioned IOPSã§MAX 20,000ã‚’æŒ‡å®šã—ãŸå ´åˆã¯ `20,000 * $0.06 = $12,000/Month`ã¨ãªã‚Šã¾ã™ã®ã§ã€Auto scale IOPSã«ã™ã‚‹ã¨IOPSã‚³ã‚¹ãƒˆã‚’å¤§å¹…(97%ç¨‹åº¦)ã«å‰Šæ¸›ã§ãã‚‹ã¨åˆ¤æ–­ã§ãã¾ã™ã€‚

## IOPSã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯å‹•çš„ã«å¤‰æ›´ãŒå¯èƒ½

å¬‰ã—ã„ã“ã¨ã«ã€Pre-provisioned IOPSã¨Auto scale IOPSã¯å‹•çš„ã«å¤‰æ›´ãŒå¯èƒ½ã§ã™ã€‚
ç¹°ã‚Šè¿”ã—ã®å¼•ç”¨ã¨ãªã‚‹[Frequently asked questions](https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-storage-iops#frequently-asked-questions)ã«ã€å¤‰æ›´ã«ã‚ãŸã£ã¦å¤šãã®æ–¹ãŒæ°—ã«ãªã‚‹ã ã‚ã†è³ªå•ã«å¯¾ã—å›ç­”ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹ã®2ç‚¹ã§ã™ã€‚

- Pre-provisioned IOPSã‹ã‚‰Auto scale IOPSã¸å¤‰æ›´ã™ã‚‹ã¨ã€å³åº§ã«å¤‰æ›´ãŒåæ˜ ã•ã‚Œã‚‹ï¼ˆã‚ã‚‰ã‚†ã‚‹é…å»¶ã¯èµ·ããªã„ï¼‰
- Auto scale IOPSã‹ã‚‰Pre-provisioned IOPSã¸æˆ»ã™ã“ã¨ã‚‚å¯èƒ½

é…å»¶ãŒãªã„(The autoscale IOPS feature is applied to your database without any delay.)ã«åŠ›å¼·ã•ã‚’æ„Ÿã˜ã¤ã¤ã€å¿…è¦ã«å¿œã˜ã¦è¡Œã£ãŸã‚Šæ¥ãŸã‚Šã§ãã‚‹ç‚¹ã¯åˆ‡ã‚Šæˆ»ã—ã®è¦³ç‚¹ã‹ã‚‰ã‚‚å¤§å¤‰ç´ æ™´ã‚‰ã—ã„ä»•çµ„ã¿ã¨è€ƒãˆã¾ã™ã€‚


## çµ‚ã‚ã‚Šã«

ä»¥ä¸Šã€ã¤ã‚‰ã¤ã‚‰ã¨Azure Database for MySQL Flexible Serverã®Auto scale IOPSã«ã¤ã„ã¦Pre-provisioned IOPSã¨æ¯”è¼ƒã—ã¤ã¤ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚

å†…å®¹ã«ã¤ã„ã¦å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ãªãŒã‚‰æ­£ç¢ºæ€§ã«æ°—ã‚’ã¤ã‘ã¾ã—ãŸãŒã€èª¤ã‚Šã¯å…¨ã¦è‘—è€…ã§ã‚ã‚‹ç§ã®è²¬ä»»ã¨ãªã‚Šã¾ã™ãŸã‚ã€ç™ºè¦‹ã•ã‚ŒãŸæ–¹ã¯ï¼ˆå¯èƒ½ãªã‚‰å„ªã—ãï¼‰æ•™ãˆã¦ã„ãŸã ã‘ã‚‹ã¨å¤§å¤‰ã‚ã‚ŠãŒãŸã„ã§ã™ã€‚ï¼ˆç‰¹ã«è¨ˆç®—å¼ã®ã‚ãŸã‚Šï¼‰

ãã‚Œã§ã¯ã¿ãªã•ã¾Enjoy ã‚³ã‚¹ãƒˆæœ€é©åŒ–ï¼†Azureï¼ï¼

## ã‚¤ã‚ªãƒ³ã‚°ãƒ«ãƒ¼ãƒ—ã§ã€ä¸€ç·’ã«åƒãã¾ã›ã‚“ã‹ï¼Ÿ

ã‚¤ã‚ªãƒ³ã‚°ãƒ«ãƒ¼ãƒ—ã§ã¯ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚’ç©æ¥µæ¡ç”¨ä¸­ã§ã™ã€‚å°‘ã—ã§ã‚‚ã”èˆˆå‘³ã‚‚ã£ãŸæ–¹ã¯ã€ã‚­ãƒ£ãƒªã‚¢ç™»éŒ²ã‚„ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«é¢è«‡ç™»éŒ²ãªã©ã‚‚ã—ã¦ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ã€‚
çš†ã•ã¾ã¨ãŠè©±ã§ãã‚‹ã®ã‚’æ¥½ã—ã¿ã«ã—ã¦ã„ã¾ã™ï¼

[![](https://storage.googleapis.com/techhire-prd-assets/AEON/ATH_engineer_Zenn%E3%83%8F%E3%82%99%E3%83%8A%E3%83%BC.png)](https://engineer-recuruiting.aeon.info/)
